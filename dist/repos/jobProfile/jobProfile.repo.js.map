{"version":3,"file":"jobProfile.repo.js","sources":["repos/jobProfile/jobProfile.repo.ts"],"sourceRoot":"/","sourcesContent":["\r\n\r\nimport JobProfile, { IJobProfileEntry } from \"@src/models/JobProfile\";\r\nimport logger from \"@src/system/logger/logger\";\r\nimport { Logger } from \"pino\";\r\n\r\n\r\n\r\nexport class JobProfileRepo \r\n{\r\n    \r\n    constructor() \r\n    {\r\n        \r\n    }\r\n\r\n    \r\n    /** Creates A new Job Profile For a User, and adds an Entry to the \"jobProfiles\" Fields */\r\n    async create\r\n    ( \r\n        userId: string, \r\n        jobProfileDoc: Pick< IJobProfileEntry, 'jobRole' | 'experienceLevel' | 'resumeUrl' | 'resumeId' >,\r\n        childLogger: Logger\r\n        \r\n    ): Promise<void> \r\n    {\r\n        const doc = { userId, jobProfiles: jobProfileDoc }\r\n        await JobProfile.create( doc )\r\n        \r\n        childLogger.debug(\"JOB_PROFILE_REPO: Job Profile Created\")\r\n    }\r\n\r\n\r\n    /** Adds a new Job Profile To the User Job Profiles  */\r\n    async addNew\r\n    (\r\n        userId: string, \r\n        jobProfileDoc: Pick< IJobProfileEntry, 'jobRole' | 'experienceLevel' | 'resumeUrl' | 'resumeId' >,\r\n        childLogger: Logger\r\n\r\n    ): Promise<number> \r\n    {\r\n        const { modifiedCount } = await JobProfile.updateOne({ userId },{ $push: { jobProfiles: jobProfileDoc }})   \r\n\r\n        childLogger.debug(\"JOB_PROFILE_REPO: ADDED NEW JOB PROFILE TO USER JOB PROFILES\")\r\n        return modifiedCount \r\n    }\r\n\r\n\r\n    /** Gets A user's Job profiles */\r\n    async getUserJobProfiles\r\n    ( \r\n        userId: string \r\n\r\n    ): Promise<  Pick<IJobProfileEntry,  'jobRole' | 'experienceLevel' | 'resumeUrl'  | 'resumeId'>[] | void |  null >\r\n    {\r\n        const result = await JobProfile.findOne({ userId }).select(\"jobProfiles\").lean() \r\n        \r\n        if( !result ) return // 404 \r\n\r\n        if( result.jobProfiles.length === 0 ) return null \r\n\r\n        return result.jobProfiles \r\n    }   \r\n\r\n\r\n    /** Updates A User's Job Profile */\r\n    async updateJobProfileEntry\r\n    (\r\n         userId: string,\r\n         updateDoc: Pick< IJobProfileEntry, 'resumeUrl' | 'resumeId' | 'experienceLevel'  | 'jobRole' >\r\n    )\r\n    {\r\n\r\n    }\r\n\r\n\r\n    async deleteProfileFromProfiles( userId: string, jobProfileId: string ): Promise<number> \r\n    {\r\n        const { modifiedCount } = await JobProfile.updateOne({ userId },{$pull:{ jobProfiles:{ _id: jobProfileId }}})\r\n        return modifiedCount\r\n    }\r\n\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA,wEAAsE;AAMtE,MAAa,cAAc;IAGvB;IAGA,CAAC;IAIK,MAAM,CAER,MAAc,EACd,aAAiG,EACjG,WAAmB;;YAInB,MAAM,GAAG,GAAG,EAAE,MAAM,EAAE,WAAW,EAAE,aAAa,EAAE,CAAA;YAClD,MAAM,oBAAU,CAAC,MAAM,CAAE,GAAG,CAAE,CAAA;YAE9B,WAAW,CAAC,KAAK,CAAC,uCAAuC,CAAC,CAAA;QAC9D,CAAC;KAAA;IAIK,MAAM,CAER,MAAc,EACd,aAAiG,EACjG,WAAmB;;YAInB,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,oBAAU,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,EAAC,EAAE,KAAK,EAAE,EAAE,WAAW,EAAE,aAAa,EAAE,EAAC,CAAC,CAAA;YAEzG,WAAW,CAAC,KAAK,CAAC,8DAA8D,CAAC,CAAA;YACjF,OAAO,aAAa,CAAA;QACxB,CAAC;KAAA;IAIK,kBAAkB,CAEpB,MAAc;;YAId,MAAM,MAAM,GAAG,MAAM,oBAAU,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAA;YAEhF,IAAI,CAAC,MAAM;gBAAG,OAAM;YAEpB,IAAI,MAAM,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC;gBAAG,OAAO,IAAI,CAAA;YAEjD,OAAO,MAAM,CAAC,WAAW,CAAA;QAC7B,CAAC;KAAA;IAIK,qBAAqB,CAEtB,MAAc,EACd,SAA8F;;QAInG,CAAC;KAAA;IAGK,yBAAyB,CAAE,MAAc,EAAE,YAAoB;;YAEjE,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,oBAAU,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,EAAC,EAAC,KAAK,EAAC,EAAE,WAAW,EAAC,EAAE,GAAG,EAAE,YAAY,EAAE,EAAC,EAAC,CAAC,CAAA;YAC7G,OAAO,aAAa,CAAA;QACxB,CAAC;KAAA;CAEJ;AA3ED,wCA2EC","debug_id":"ea40a56c-dba6-57ce-ab35-0281b89d047d"}