{"version":3,"file":"user.js","sources":["controller/user/user.ts"],"sourceRoot":"/","sourcesContent":["import { UserService } from \"@src/services/user/user\";\r\nimport { UserRepository } from \"@src/repos/user/user.repo\";\r\nimport  { Request, Response } from \"express-serve-static-core\" \r\nimport { MarkLearningModuleAsCompletedSchema, SaveUserFirstAndLastNameSchema, SignupInput, VerifyUserSchema} from \"@src/schemas/user/signupSchema\";\r\nimport { UserSigninDTO } from \"@src/DTOs/user/user\";\r\nimport jwt from \"jsonwebtoken\"\r\nimport { config } from \"dotenv\"\r\nconfig() \r\n\r\n// Interfaces \r\nimport { NotFoundError } from \"@src/util/Errors/Endpoints/notFoundError\";\r\nimport { SaveLearningModuleOverviewSchema } from \"@src/schemas/learningModule/learningModule.schema\";\r\nimport { ILearningModuleOverview } from \"@src/models/learningProfile\";\r\nimport { AnyAppError } from \"@src/util/Errors/Endpoints/anyAppError\";\r\nimport { ConflictError } from \"@src/util/Errors/Endpoints/conflictError\";\r\nimport logger from \"@src/system/logger/logger\";\r\nimport { generateJwtToken } from \"@src/util/Auth/tokens\";\r\nimport { IUserRequest } from \"types\";\r\nimport { startRedis } from \"@src/middleware/cache/redisClient\";\r\n\r\n\r\nexport class UserController \r\n{\r\n\r\n    private userService: UserService\r\n\r\n    constructor()\r\n    {\r\n        const userRepository = new UserRepository() \r\n        this.userService = new UserService( userRepository ) \r\n    }   \r\n\r\n\r\n    async signup(req: Request<{}, {}, SignupInput[\"body\"]>, res: Response)\r\n    {\r\n        try \r\n        {\r\n                 \r\n\r\n        logger.info(`User_Signup_Controller: Signin Up New User`)\r\n\r\n        const email = req.body.email \r\n        const userExists = await this.userService.findByEmail( email ) \r\n\r\n        if( userExists )\r\n        {\r\n            logger.info(`User Email: ${ email } Taken `)\r\n            throw new ConflictError(\"Account with this email exists\")\r\n        }\r\n\r\n        const protocol = req.protocol || 'https' || 'http'\r\n        const host = req.get('host') || 'localhost:3000'\r\n        const domain = `${protocol}://${host}`\r\n\r\n        await this.userService.create( req.body, domain  )\r\n        \r\n        return res.status(201).json({ status: \"success\", msg:\"User Signup Successfull\" })\r\n\r\n        }\r\n        catch(e: any )\r\n        {\r\n            const err: AnyAppError = e as AnyAppError\r\n\r\n            if( !err.statusCode ) return res.status(500).json({ success: false, msg:\"SERVER ERROR\"})\r\n\r\n            return res.status( err.statusCode ).json({ success: false, msg: err.message })\r\n        }\r\n    }\r\n\r\n    async signin( req: Request<{}, {}, UserSigninDTO>, res: Response )\r\n    {\r\n        try \r\n        {\r\n             const { password, email } = req.body \r\n\r\n             const response = await this.userService.signin( email, password )\r\n\r\n             return res.status(200).json( response ) \r\n        \r\n        }\r\n        catch(e: any )\r\n        {\r\n            const err = e as AnyAppError\r\n            console.log(err) \r\n            if( !err.statusCode ) return res.status(500).json({ success: false, msg:\"Server Error\"}) \r\n            return res.status( err.statusCode  ).json({ success: false, message: e.message })\r\n        }\r\n    }\r\n\r\n    async update(req: Request<{},{},SaveUserFirstAndLastNameSchema['body']>, res: Response )\r\n    {\r\n        try \r\n        {\r\n            const userId = req.user?._id\r\n\r\n            if( !userId ) return res.status(500).json({ success: false, msg:\"Server Error\" })\r\n\r\n            const updateBody = req.body \r\n\r\n            await this.userService.update( userId, updateBody ) \r\n\r\n            return res.status(200).json({ success: true, msg:\"User Update Successful\"})\r\n        }\r\n        catch(err: any )\r\n        {\r\n            const e = err as AnyAppError \r\n\r\n            if( !e.statusCode ) return res.status(500).json({ success: false, msg:\"Server Error\"})\r\n                \r\n            return res.status( e.statusCode ).json({ success: false, msg: e.message }) \r\n        }\r\n    }\r\n\r\n\r\n    async signinWithGoogle(req: Request, res: Response )\r\n    {\r\n        try \r\n        {\r\n           \r\n            var user = req.user \r\n\r\n            console.log( req.user ) \r\n            if( !user ) return res.status(500).json({ success: false, msg:\"User Object Empty\" })\r\n                \r\n            // User Details \r\n            const { _id, firstname, lastname,email, learningProfile, newUser, userHasCreatedFirstJobProfile } = user \r\n            const signDetails = { _id, email,  firstname,lastname }\r\n\r\n            // JWT Tokens \r\n            const accessToken = generateJwtToken( signDetails )\r\n            const refreshToken = generateJwtToken( signDetails )\r\n           \r\n    \r\n            // Data For NewUser \r\n            const newUserReturnData = { user:{  newUser: true, firstname, lastname, userHasCreatedFirstJobProfile }, tokens:{ accessToken, refreshToken}  }\r\n\r\n            if( newUser ) \r\n            {\r\n                return res.status(200).json({ success: true, data: newUserReturnData } ) // Returns New User Details  \r\n            }\r\n            \r\n            const userReturnData = {  user:{  newUser: false, userId: _id, firstname, lastname, userHasCreatedFirstJobProfile,  learningProfile}, tokens:{ accessToken, refreshToken } }\r\n\r\n            return res.status(200).json({ success: true, data: userReturnData }) // Returns User Details \r\n        }\r\n        catch( err : any ) \r\n        {\r\n            const e = err as AnyAppError \r\n            if( !e.statusCode ) return res.status(500).json({ success: false, msg: \"Server Error\" })\r\n\r\n            return res.status( e.statusCode ).json({ success: false, msg: e.message }) \r\n        }\r\n    }\r\n\r\n    async verifyUser( req: Request<{},{},{}, VerifyUserSchema['query']>, res: Response)\r\n    {\r\n        try \r\n        {\r\n            const userID = req.query.token \r\n\r\n            await this.userService.verifyUser( userID ) \r\n        \r\n            return res.status(200).json({ success: true, msg:\"User Verified\"})\r\n        }\r\n        catch(e: any)\r\n        {\r\n            const err = e as AnyAppError\r\n\r\n            if( !err.statusCode ) return res.status(500).json({ success: false, msg:\"Server Error\"})\r\n\r\n            return res.status( err.statusCode ).json({ success: false, msg: err.message })\r\n        }\r\n    }\r\n\r\n    async skipOnboarding(req: Request, res: Response)\r\n    {\r\n        try \r\n        {\r\n            const userId = req.user?._id \r\n            if( !userId ){ return res.status(400).json({ success: false, msg:\"could not authenticate user\"})}\r\n\r\n            await this.userService.setUserNewToFalse( userId )\r\n            return res.status(200).json({ success: true, msg:\"Onboarding Skipped\"})\r\n        }\r\n        catch(e: any)\r\n        {\r\n            if( e instanceof NotFoundError )\r\n            {\r\n                return res.status( e.statusCode ).json({ success: false, msg: e.message })\r\n            }\r\n\r\n                return res.status(500).json({ success: false, msg: \"Server Error\"})\r\n        }\r\n    }\r\n\r\n    async addLearningModulesToUserProfile(req: Request<{},{},SaveLearningModuleOverviewSchema['body']>, res: Response)\r\n    {\r\n        try \r\n        {\r\n            const userId = req.user?._id \r\n            if( !userId ) return res.status(401).json({ success: false, msg:\"could not authenticated user\"})\r\n            \r\n            const learningModuleOverview = req.body.learningModules as unknown as ILearningModuleOverview[]\r\n            await this.userService.saveUserLearningModuleOverview( userId, learningModuleOverview)\r\n            return res.status(200).json({ success: true, msg:\"Learning Modules Overview Saved to user Learning Profile\"})\r\n        }\r\n        catch(e: any)\r\n        {\r\n           \r\n                const err = e as AnyAppError\r\n                if( !err.statusCode ) return res.status(500).json({ success: false, msg: 'Server Error' })\r\n                \r\n                return res.status( err.statusCode ).json({ success: false, msg: err.message }) \r\n        }\r\n    }\r\n\r\n    async markUserLearningPartAsComplete(req: Request<{},{}, MarkLearningModuleAsCompletedSchema['body']>, res: Response )\r\n    {\r\n        try \r\n        {\r\n            const {_id,partTitle  } = req.body \r\n            const userId = req.user?._id || '' \r\n\r\n\r\n            this.userService.markLearningModulePartAsCompleted( userId, _id, partTitle )\r\n            return res.status(200).json({ success: true, msg:\"Successfully marked part as completed\"})\r\n        }\r\n        catch(err: any )\r\n        {\r\n            const e = err as AnyAppError\r\n\r\n            if( !e.statusCode ) return res.status(500).json({ success: false, msg: e.message })\r\n            return res.status(e.statusCode).json({ success: false, msg: e.message })\r\n        }\r\n    }\r\n\r\n    async getNewAccessToken(req: Request, res: Response)\r\n    {\r\n\r\n        const cache = await startRedis() \r\n\r\n                try \r\n                {\r\n                    \r\n                    const { refreshToken } = req.body;\r\n                    if (!refreshToken) return res.sendStatus(401);\r\n                    \r\n                    \r\n                    var refreshTokenValue = await cache?.get(refreshToken)\r\n                    console.log( refreshTokenValue )\r\n                    console.log(':::>')\r\n                    if (!refreshTokenValue) return res.sendStatus(403);\r\n\r\n                    refreshTokenValue = refreshTokenValue.replace(/\"/g, '')\r\n                \r\n                    const decoded = jwt.verify(refreshTokenValue, process.env.JWT_REFRESH_TOKEN_SECRET || '' )\r\n\r\n                    const token = generateJwtToken( decoded as IUserRequest)\r\n\r\n                    return res.status(200).json({ success: true, accessToken: token })\r\n                }\r\n                catch(e: any)\r\n                {\r\n                    logger.error(e,'here....')\r\n                    return res.status(500).json({ success: false, msg: e.message })\r\n                }\r\n                finally \r\n                {\r\n                    await cache?.quit() \r\n                }\r\n    }\r\n\r\n} "],"names":[],"mappings":"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","debug_id":"b3fcef45-19a3-5b4b-abb5-847d476b266d"}