{"version":3,"file":"logContext.js","sources":["middleware/context/logContext.ts"],"sourceRoot":"/","sourcesContent":["import {config  } from \"dotenv\"\r\nconfig() \r\nimport { Request, Response, NextFunction} from \"express-serve-static-core\"\r\nimport { IUserLogContext } from \"types\"\r\nimport { v4 as uuidv4 } from \"uuid\" \r\n\r\nexport function addUserContext( req: Request, res: Response, next: NextFunction )\r\n{\r\n\r\n    if( !req.user?._id ) return res.status(500).json({ success: false, msg: \"Server Error\"})\r\n\r\n    const context: IUserLogContext = \r\n    {\r\n        userId: req.user?._id, \r\n        requestId: uuidv4(), \r\n        endPoint: req.originalUrl, \r\n        httpMethod: req.method, \r\n        clientIp: req.ip || 'unknown', \r\n        environment: process.env.NODE_ENV,\r\n        userAgent: req.headers['user-agent'], \r\n        timeStamp: new Date().toISOString()   \r\n    }\r\n\r\n    \r\n    req.context = context \r\n    console.log(\"----Debug-----\")\r\n    console.log( req.context  ) \r\n    next() \r\n}"],"names":[],"mappings":";;;;AAMA,wCAsBC;AA5BD,mCAA+B;AAC/B,IAAA,eAAM,GAAE,CAAA;AAGR,+BAAmC;AAEnC,SAAgB,cAAc,CAAE,GAAY,EAAE,GAAa,EAAE,IAAkB;;IAG3E,IAAI,CAAC,CAAA,MAAA,GAAG,CAAC,IAAI,0CAAE,GAAG,CAAA;QAAG,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,cAAc,EAAC,CAAC,CAAA;IAExF,MAAM,OAAO,GACb;QACI,MAAM,EAAE,MAAA,GAAG,CAAC,IAAI,0CAAE,GAAG;QACrB,SAAS,EAAE,IAAA,SAAM,GAAE;QACnB,QAAQ,EAAE,GAAG,CAAC,WAAW;QACzB,UAAU,EAAE,GAAG,CAAC,MAAM;QACtB,QAAQ,EAAE,GAAG,CAAC,EAAE,IAAI,SAAS;QAC7B,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ;QACjC,SAAS,EAAE,GAAG,CAAC,OAAO,CAAC,YAAY,CAAC;QACpC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;KACtC,CAAA;IAGD,GAAG,CAAC,OAAO,GAAG,OAAO,CAAA;IACrB,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAA;IAC7B,OAAO,CAAC,GAAG,CAAE,GAAG,CAAC,OAAO,CAAG,CAAA;IAC3B,IAAI,EAAE,CAAA;AACV,CAAC","debug_id":"e5d4eb93-6c0a-5100-8ae6-440658c28b85"}